---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PatternCard from '../../components/PatternCard.astro';
import { patterns, categoryMeta, type Category } from '../../data/patterns';

const categories = ['creational', 'structural', 'behavioral'] as const;
---

<BaseLayout
  title="All Design Patterns â€” NestJS Design Patterns"
  description="Browse all 23 Gang of Four design patterns implemented with NestJS and TypeScript."
>
  <section class="border-b border-gray-200 bg-gradient-to-b from-gray-50 to-white">
    <div class="mx-auto max-w-6xl px-4 py-12 sm:px-6">
      <h1 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">All Design Patterns</h1>
      <p class="mt-3 text-lg text-gray-600">
        All 23 Gang of Four design patterns, organized by category. Each includes a real-world e-commerce example built with NestJS.
      </p>
    </div>
  </section>

  <div class="mx-auto max-w-6xl px-4 py-12 sm:px-6 space-y-16">
    {categories.map((cat) => {
      const meta = categoryMeta[cat];
      const catPatterns = patterns.filter(p => p.category === cat).sort((a, b) => a.order - b.order);

      return (
        <section>
          <div class="flex items-center gap-3 mb-6">
            <h2 class="text-2xl font-bold text-gray-900">{meta.label}</h2>
            <span class="rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-600">
              {meta.count} patterns
            </span>
          </div>
          <p class="mb-6 text-gray-600">{meta.description}</p>
          <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
            {catPatterns.map((p) => (
              <PatternCard
                title={p.title}
                slug={p.slug}
                category={p.category}
                intent={p.intent}
                complexity={p.complexity}
              />
            ))}
          </div>
        </section>
      );
    })}
  </div>
</BaseLayout>
